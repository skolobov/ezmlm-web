This file is part of gpgpy-ezmlm - an encryption filter for the
ezmlm mailinglist manager.

Installation and configuration issues are described.

Copyright 02007 Sense.Lab e.V. <info@senselab.org>

gpgpy-ezmlm is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or
(at your option) any later version.

gpgpy-ezmlm is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with the CryptoBox; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA

--------------------------------------------------------------

Table of contents:
	1) Requirements
	2) Get the source
	3) Installation
	4) Integration with qmail
	5) Managing encrypted mailing lists
	6) Interoperability issues
	7) Report bugs / feedback

--------------------------------------------------------------

1) Requirements:
 - python2.4
 - python-pyme
 - qmail
 - ezmlm-idx (v0.431 or higher)


2) Get the source
The current release of gpgpy-ezmlm can be obtained from:

 https://systemausfall.org/toolforge/gpgpy-ezmlm

Extract the compressed archive and read README.


3) Installation
This should be trivial for default installations:
	make
	make install
	make test

Please fix any problems, that may occour during the tests.

Non-default installations can be customized - run "make help" for details.

Afterwards the scripts and man pages are installed to their appropriate
locations. You still need to follow the instructions of section
"Integration with qmail" below.


4) Integration with qmail
Add the following environment setting to your qmail startup script
(e.g. /var/qmail/rc):

 QMAILQUEUE=/usr/local/bin/gpgpy-ezmlm-queue

The default rc file would look like the following:
 
 #!/bin/sh
 exec env - PATH="/var/qmail/bin:$PATH" \
 QMAILQUEUE=/usr/local/bin/gpgpy-ezmlm-queue \
 qmail-start "`cat /var/qmail/control/defaultdelivery`"

Now you should restart qmail.


5) Managing encrypted mailing lists
Use the gpgpy-ezmlm-manage program to enable or disable gnupg encryption
for a specific list or to generate the secret key of a list.
BEWARE: you should run all of the following actions as the user that
manages the specific mailing list (e.g. vlists, vpopmail, ???). Otherwise
it is quite likely that you will create permission problems, which will show
up later during mail delivery.

If you want to enable encryption for a mailing list, then you should run:

 /usr/local/bin/gpgpy-ezmlm-manage MAILINGLIST_DIR enable
 /usr/local/bin/gpgpy-ezmlm-manage MAILINGLIST_DIR genkey

This enables encryption for the specific list by creating the configuration
file "conf-gpgpy" in the list directory. Take a look at it for details.
Afterwards a new key is generated - every encrypted mailinglist needs a secret
key (without a passphrase) to decrypt incoming mails. Additionally you may
supply some description for the key (name, comment and mail address) -
otherwise these information are (wisely) guessed by the program. 

Now you should import the keys of all recipients of this list to the gnupg
key directory of the list. You can retrieve the location of this directory by
running the following command:

 /usr/local/bin/gpgpy-ezmlm-manage MAILINGLIST_DIR get_gnupg_dir

For example you could import a new public key by issuing:

 gnupg --homedir MAILINGLIST_GNUPG_DIR --import KEYFILE


6) Interoperability issues
If you already use the QMAILQUEUE setting to integrate a spam filter into your
qmail setup (e.g. ifspamh), then you can still use gpgpy-ezmlm, too.
Simply use GPGPY_QMAILQUEUE instead of QMAILQUEUE for your spam filtering
program. This tells gpgpy-ezmlm to use the spam filtering program instead
of qmail-queue for mail queueing.


7) Report bugs / feedback
Please send any reports about problems or successful installations to
devel@sumpfralle.de. Thanks!

Or report bugs: 
  https://systemausfall.org/trac/ezmlm-web/newticket (component: "gpgpy-ezmlm")

